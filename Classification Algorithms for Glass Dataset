import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.neighbors import KNeighborsClassifier
from sklearn.svm import SVC
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score, precision_score,
recall_score, f1_score, confusion_matrix
data = pd.read_csv("/kaggle/input/glass/glass.csv")
X = data.drop("Type", axis=1)
y = data["Type"]
X_train, X_test, y_train, y_test = train_test_split(X, y,
test_size=0.2, random_state=42, stratify=y)
scaler = StandardScaler()
X_train = scaler.fit_transform(X_train)
X_test = scaler.transform(X_test)
models = {
 "KNN": KNeighborsClassifier(n_neighbors=5),
 "SVM": SVC(kernel="rbf", C=1, gamma="scale",
random_state=42),
 "Random Forest": RandomForestClassifier(n_estimators=100,
random_state=42)
}
results = []
for name, model in models.items():
 model.fit(X_train, y_train)
 y_pred = model.predict(X_test)
 acc = accuracy_score(y_test, y_pred)
 pre = precision_score(y_test, y_pred, average="weighted",
zero_division=0)
 rec = recall_score(y_test, y_pred, average="weighted",
zero_division=0)
 f1 = f1_score(y_test, y_pred, average="weighted")
 cm = confusion_matrix(y_test, y_pred)
 results.append({"Model": name, "Accuracy": acc, "Precision":
pre, "Recall": rec, "F1 Score": f1})
 plt.figure(figsize=(5,4))
 sns.heatmap(cm, annot=True, fmt='d', cmap='Blues')
 plt.title(f'{name} Confusion Matrix')
 plt.xlabel('Tahmin Edilen')
 plt.ylabel('Ger√ßek')
 plt.show()
comparison = pd.DataFrame(results)
print(comparison.sort_values(by="F1 Score", ascending=False))
plt.figure(figsize=(7,5))
sns.barplot(x="Model", y="F1 Score", data=comparison)
plt.ylim(0,1)
plt.show()
